<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui">

<link href='https://fonts.googleapis.com/css?family=Poiret+One'
	rel='stylesheet' type='text/css' />

<h:head>
	<h:outputStylesheet name="css/main.css" />
</h:head>
<body>
	<header role="banner">
		<h:graphicImage styleClass="headerLogo"
			value="/resources/img/logo.jpg" width="10%" />
	</header>
	<div class="titlebar">
		<h:link class="titlebarItem" value="!! Unbekannter Benutzer !!" outcome="signin" rendered="#{!signinView.loggedIn}"/>
		<p:outputLabel class="titlebarItem" value="Angemeldet:  #{signinView.loginName}"  rendered="#{signinView.loggedIn}" />
		<h:form id="logout">
			<p:commandButton id="logout_button" class="titlebarItem" value="Logout" action="#{homeView.logout()}" style="color: black !important; font-size: small !important; margin-right: 5px;" />
		</h:form>	
	</div>
	<p:messages id="menumessages" showDetail="false" autoUpdate="true" />
	
	<nav>
	
	
		<h:form id="navigation">
			<p:tieredMenu>
				<p:submenu label="Projektstundenübersicht">
					<p:menuitem value="Hochladen" actionListener="#{mainMenuView.upload()}" update="menumessages" />
					<p:menuitem value="Verrechnet" actionListener="#{mainMenuView.invoiced()}" update="menumessages"></p:menuitem>
				</p:submenu>
				<p:submenu label="Urlaubsverwaltung">
					<p:menuitem value="Urlaubsantrag" actionListener="#{mainMenuView.vacation()}" update="menumessages" />
				</p:submenu>
				<p:submenu label="Benutzerverwaltung" rendered="#{homeView.admin}" >
					<p:menuitem value="Benutzer registrieren" outcome="admin_signup" />
					<p:menuitem value="Benutzer bearbeiten" actionListener="#{mainMenuView.changeUser()}" update="menumessages" />
					<p:menuitem value="Benutzerübersicht" actionListener="#{mainMenuView.allUsers()}" update="menumessages" />
				</p:submenu>
				<p:submenu label="Projektverwaltung" rendered="#{homeView.admin}">
					<p:menuitem value="Kundenprojekt anlegen" actionListener="return null;" />
					<p:menuitem value="MA Zuordnung" actionListener="return null;" />
				</p:submenu>
			</p:tieredMenu>
		</h:form>


	</nav>	

	<h:form id="main">
		<p:layout style="min-width:400px;min-height:300px;">
			<p:layoutUnit position="west" resizable="true" size="300"
				minSize="40">
				<h:outputLabel value="#{homeView.curDate}" id="blub"/>
				<p:calendar id="inline" value="#{homeView.curDate}" mode="inline" required="true"> 

				</p:calendar>
			</p:layoutUnit>
			<p:layoutUnit position="center">

				<p:messages id="messages" showDetail="false" autoUpdate="true" />


				<p:dataTable id="Hours" var="curHour"
					value="#{homeView.commitDisplay}" editable="true"
					style="margin-bottom:20px">
					<f:facet name="header">
           Row Editing
       </f:facet>

					<p:ajax event="rowEdit" listener="#{homeView.onRowEdit}"
						update=":main:messages" />
					<p:ajax event="rowEditCancel" listener="#{homeView.onRowCancel}"
						update=":main:messages" />
					<p:column headerText="Beschreibung">
						<p:cellEditor>
							<f:facet name="output">
								<h:outputText value="#{curHour.description}" />
							</f:facet>
							<f:facet name="input">
								<p:inputText id="modelInput" value="#{curHour.description}"
									style="width:100%" />
							</f:facet>
						</p:cellEditor>
					</p:column>

					<p:column headerText="Projekt" style="width:7em">
						<p:cellEditor>
							<f:facet name="output">
								<h:outputText value="Dummyprojekt" />
							</f:facet>
							<f:facet name="input">
								<h:outputText value="Dummyprojekt" />
							</f:facet>
						</p:cellEditor>
					</p:column>

					<p:column headerText="Kategorie" style="width:5em">
						<p:cellEditor>
							<f:facet name="output">
								<h:outputText value="Sonstiges" />
							</f:facet>
							<f:facet name="input">
								<h:outputText value="Sonstiges" />
							</f:facet>
						</p:cellEditor>
					</p:column>

					<p:column headerText="Start" style="width:3em">
						<p:cellEditor>
							<f:facet name="output">
								<h:outputText value="#{curHour.start}">
									 <f:convertDateTime pattern="HH:mm" timeZone="Europe/Berlin" />
								</h:outputText>
							</f:facet>
							<f:facet name="input">
								<p:calendar id="timeStart" value="#{curHour.start}"
									pattern="HH:mm" timeOnly="true" />
							</f:facet>
						</p:cellEditor>
					</p:column>

					<p:column headerText="Ende" style="width:3em">
						<p:cellEditor>
							<f:facet name="output">
								<h:outputText value="#{curHour.stop}">
									<f:convertDateTime pattern="HH:mm" timeZone="Europe/Berlin" />
								</h:outputText>
							</f:facet>
							<f:facet name="input">
								<p:calendar id="timeStop" value="#{curHour.stop}"
									pattern="HH:mm" timeOnly="true" />
							</f:facet>
						</p:cellEditor>
					</p:column>


					<p:column style="width:32px">
						<p:rowEditor />
					</p:column>
				</p:dataTable>
				<p:commandButton update="main" value="Buchen" action="#{homeView.commitTime()}"/>
			</p:layoutUnit>
		</p:layout>
 	</h:form>


</body>
</html>
